<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">

<html>

<head>
    <meta http-equiv="Content-Language" content="en-us">
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <title>ergatis - installation guide</title>
    <link rel="stylesheet" type="text/css" href="../css/common.css">
    <link rel="stylesheet" type="text/css" href="../css/header.css">
    <link rel="stylesheet" type="text/css" href="../css/monitor.css">
    <link rel="stylesheet" type="text/css" href="../css/documentation.css">
    <link rel="stylesheet" type="text/css" href="../css/sourceforge.css">
</head>

<body class='documentation'>

<div id='page_container'>

    <div id='page_header'>
        <div id='quick_links_container'>
            <ul id='quick_links'>
                <li><a href='http://www.igs.umaryland.edu'>IGS</a></li>
                <li class='last'><a href='http://www.sf.net/projects/ergatis'>SF site</a></li>
            </ul>
        </div>
        <div id='title_container'>
            <span id='page_title'>ergatis</span>
            <span id='page_slogan'>workflow creation and monitoring interface</span>
        </div>
    </div>

    <div id='primary_nav_container'>
        <ul id='primary_nav_elements'>
            <li id='nav_home'><a href="../index.html">home</a></li>
            <li id='nav_screenshots'><a href="../screenshots.html">screenshots</a></li>
            <li id='nav_documentation'><a href="../documentation.html">documentation</a></li>
            <li id='nav_download'><a href="../download.html">download</a></li>
        </ul>
    </div>

    <div id='sub_nav_container'>
        <ul id='sub_nav_elements'>
            <li class='last'><a href='../index.html'>home</a></li>
        </ul>
    </div>

    <div id='content_container'>
    
        <div id='section1'>
            <h2>download</h2>
            <p>
            <a href='http://sourceforge.net/project/showfiles.php?group_id=148765'>Get the packages here</a>
            </p>
            <h2>required perl modules</h2>

            <ul id='required_perl_modules'>
                <li><a href='http://bsml.sourceforge.net/'>BSML</a></li>
                <li>Bio::Seq</li>
                <li>CDB_File</li>
                <li>Class::Struct</li>
                <li>Config::IniFiles</li>
                <li>DB_File</li>
                <li>Data::Dumper</li>
                <li>Date::Manip</li>
                <li>ExtUtils::MakeMaker (&gt;=6.31)
                <li>File::Basename</li>
                <li>File::Copy</li>
                <li>File::Find</li>
                <li>File::Mirror</li>
                <li>File::Path</li>
                <li>File::Spec</li>
                <li>Getopt::Long</li>
                <li>HTML::Template</li>
                <li>IO::File</li>
                <li>IO::Tee</li>
                <li>IPC::Open3</li>
                <li>LWP::Simple</li>
                <li>Log::Cabin</li>
                <li>Log::Log4perl</li>
                <li>Mail::Mailer</li>
                <li>Math::Combinatorics</li>
                <li>PerlIO::gzip</li>
                <li>Storable</li>
                <li>URI::Escape</li>
                <li>XML::Parser</li>
                <li>XML::RSS</li>
                <li>XML::Twig</li>
                <li>XML::Writer</li>
            </ul>
        </div>

        <div id='section2'>
            <h2>documentation - installation guide</h2>
            <p>
                This document is designed to help you get Ergatis up and running.  For those of you who like to jump
                right in and do it yourself you can skip down the the quick install guide.  For a more detailed
                explanation of the requirements, architecture, best practices, etc. read on.
            </p>
            <ul id='install_sections'>

                <li><a href='#requirements'>requirements</a></li>
                <li><a href='#downloading_packages'>downloading Ergatis packages</a></li>
                <li><a href='#quick_install'>quick install</a></li>
                <li><a href='#detailed_install'>detailed install</a></li>
                <li class='sublist_container'>
                    <ul>
                        <li><a href='#layout_plan'>planning your layout</a></li>
                        <li><a href='#performing_install'>performing the install</a></li>
                        <li><a href='#interface_configuration'>interface configuration</a></li>
                        <li><a href='#software_path'>software path configuration</a></li>
                        <li><a href='#project_area'>setting up a project area</a></li>
                    </ul>
                </li>
            </ul>
            
            <a name='requirements'></a>
            <h3>requirements</h3>
            <p>
                Getting the requirements up and running will take far more time than actually setting up Ergatis
                itself.  This is a software package designed to allow users to easily build and manage pipelines
                on a compute grid, after all, so actually <emph>having<emph> a compute grid available (though not
                technically required) will be one of the first challenges.
            </p>
            <dl>
                <dt><a href='http://sourceforge.net/projects/tigr-workflow'>Workflow Engine</a></dt>
                <dd>
                    Workflow Engine processes the XML representing the work to be done that is generated by Ergatis.
                </dd>
                <dt><a href='http://gridengine.sunsource.net/'>Sun Grid Engine</a></dt>
                <dd>
                    If you plan to use Ergatis to run jobs on a compute grid a Workflow Engine-supported
                    grid management software installation must be in place.  The most popular choice is the
                    freely-available Sun Grid Engine.
                </dd>
                <dt><a href='http://www.apache.org/'>Web server</a></dt>
                <dd>

                    Because Ergatis is a web-based interface, so you'll need a web server, such as Apache.
                </dd>
                <dt><a href='http://www.cpan.org/src/README.html'>Perl 5.8.0 or higher and selected modules</a></dt>
                <dd>
                    Your installed Perl must be at least version 5.8.0.  Also, the modules listed in the column on
                    the right are required.  (The Ergatis installer will check for these and complain if you don't
                    have any.)  Note that the first module (<a href='http://bsml.sourceforge.net/'>BSML</a>) isn't 
                    currently available on CPAN and is an independant SourceForge project. 
                </dd>
            </dl>
            <p>
                The Workflow Engine contains a test suite that allows you to ensure that you can successfully
                submit and track jobs on your grid.  With these, a web server and perl modules in place you are 
                ready to install Ergatis.
            </p>
            <a name='downloading_packages'></a>
            <h3>downloading Ergatis packages</h3>
            <p>
                Ergatis is freely available under the open-source <a href='http://www.opensource.org/licenses/artistic-license.php'>
                Artistic License</a> and can be loaded from from the <a href='http://sourceforge.net/project/showfiles.php?group_id=148765'>
                file release page</a> on SourceForge.  You'll notice several different packages available on that
                page and each are described below.  Depending on your anticipated usage you may only need one of them.
            </p>
            <dl>
                <dt>ergatis</dt>
                <dl>
                    All installations will require this package.  It contains the web interface and all the software
                    and components for building analysis pipelines.  The other components are optional.
                </dl>
                <dt>coati</dt>
                <dl>
                    Optional.  This is our three-tiered architecture built on top of DBI that enables transparent 
                    database connectivity for Perl programs across different schema and vendor types.  You only need
                    to install it if you plan on using the Ergatis components utilize relational databases.
                </dl>
                <dt>ontologies and chado</dt>
                <dl>
                    Optional. Much of Ergatis in general and everything involving database loading specifically
                    makes extensive use of controlled vocabularies including the Gene Ontology and Sequence
                    Ontology.  This package provides the collection of ontologies used throughout the software.
                </dl>
                <dt>prism (shared)</dt>
                <dl>
                    Optional. Prism inherits from and extends Coati's features with the emphasis on interactivity 
                    with the <a href='http://blog.gmod.org/?q=node/6'>chado schema</a>.  The Prism API provides methods for efficient data loading and retrieval to and 
                    from a chado database.  This package contains the shared components of prism that are required
                    regardless of schema employeed.
                </dl>
                <dt>prism (chado schema)</dt>
                <dl>
                    Optional.  Extends prism to include utilities to load/retrieve data from a chado schema.
                </dl>
                <dt>prism (TIGR euk schema)</dt>
                <dl>

                    Optional.  Extends prism to include utilities to load/retrieve data from a TIGR-specific
                    eukaryotic 'legacy' schema.
                </dl>
                <dt>prism (TIGR prok schema)</dt>
                <dl>
                    Optional.  Extends prism to include utilities to load/retrieve data from a TIGR-specific
                    prokaryotic 'legacy' schema.
                </dl>
            </dl>
            
            <a name='quick_install'></a>
            <h3>quick install</h3>

            <p>
                If you just want the basic descriptions of the steps involved this is the section for you.  If you
                want a detailed guide skip to the next section, 'detailed install'
            </p>
            <ol>
                <li><a href='http://sourceforge.net/project/showfiles.php?group_id=148765&package_id=164118'>download ergatis</a></li>
                <li>extract and run the Makefile.PL (specifying some INSTALL_BASE)</li>
                <li>make</li>
                <li>make install</li>
                <li>rename the htdocs directory to 'ergatis' (or whatever you like) and place it in your webserver's htdocs/html directory</li>
                <li>modify your apache configuration to allow CGI script execution within the ergatis directory</li>
                <li>read and customize your new /ergatis/cgi/ergatis.ini config file</li>
                <li>read and edit your INSTALL_BASE/software.config file</li>
                <li>run the check_installation.pl script packaged with the installer (reads your ergatis.ini)</li>
                <li>point your browser to http://yourserver/ergatis</li>
                <li>use the 'admin' tab to set up your first project</li>
            </ol>
            <p>
                The sections below provide more information and background.
            </p>
            
            <a name='detailed_install'></a>
            <h2>detailed install</h2>
            
            <a name='layout_plan'></a>
            <h3>planning your layout</h3>

            <p>
                A bit of planning can save you a lot of grief when you layout your directory structure.  Most paths
                in Ergatis are configurable and most institutions usually find a directory convention that works
                for them.  Here I'll describe the core directories you'll need to create with examples at the
                end of each description.  As you read through the ergatis.ini file you'll find descriptions for
                all needed files, directories and parameters.
            </p>
            <dl>
                <dt>ergatis directory</dt>
                <dd>
                    This is a directory where you'll install the perl scripts and component files that make
                    up Ergatis, excluding the interface code (which lives instead under your web server.)  When you compile
                    Ergatis using the Makefile.PL this is the path you'll pass via the INSTALL_BASE parameter to direct
                    its installation location.  Some people create more than one of these for different software
                    versions (discussed later.)  <strong>Example: /opt/ergatis</strong>
                <dd>

                <dt>project area</dt>
                <dd>
                    These are completely user-configurable and many institutions will have more than one.  If I'm annotating
                    two different organisms, for example, and want to keep their pipelines and data separate from each other
                    I'll create one project area for each organism.  The interface easily supports the display of dozens of
                    these project areas via customization of the ergatis.ini file.  <strong>Examples: /usr/local/projects/e_coli,
                    /usr/local/projects/a_aegypti</strong>
                <dd>
                
                <dt>global ID repository</dt>
                <dd>
                    Ergatis uses a file-based system for generating IDs, such as new pipeline or feature IDs.  Each project
                    area will have it's own ID repository (created automatically) but the interface does need the path
                    to an area it can use for global IDs - those that can be used across projects.  Pipeline IDs are an
                    example of global IDs because they are unique across all projects.  This directory is specified in
                    the ergatis.ini file. <strong>Example: /opt/global_id_repository</strong>
                <dd>
                
                <dt>temp directory</dt>
                <dd>
                    This is a directory with open permissions where Ergatis can create temporary files and folders.  It 
                    is used both by the interface and running pipelines components.  <strong>Example: /tmp/ergatis</strong>
                <dd>
            </dl>
            
            <a name='performing_install'></a>

            <h3>performing the install</h3>
            <p>
                Using these example directories, we'll now go through an example install.  If you've downloaded the current
                version from the <a href='http://sourceforge.net/project/showfiles.php?group_id=148765'>SourceForge site</a>
                you should have a tarball named like ergatis-v2rNbN.tar.gz where the Ns are some version numbers.  From here
                on in the guide you'll need to replace this with the name of the file you downloaded.  You should
                be able to extract it like this:
            </p>
            <p class='code'>
    tar -xvzf ergatis-v2rNbN.tar.gz
            </p>
            <p>
                This will create a directory called ergatis-v2rNbN.  Change into that directory:
            </p>
            <p class='code'>
    cd ergatis-v2rNbN
            </p>
            <p>
                Here you should see several files and directories, among them the Makefile.PL.  Using the directory examples
                above, we'll perform the install with these three commands:
            </p>
            <p class='code'>

    /usr/local/bin/perl Makefile.PL INSTALL_BASE=/opt/ergatis

    make

    make install
            </p>
            <p>
                Next you'll need to copy the interface files into your web server's directory structure.  This involves
                one simple copy command.  In this example I'm using apache and my html directory is under
                /var/www/ .  From the same directory as we've executed the previous commands we'll now do:
            </p>
            <p class='code'>
    cp -r htdocs /var/www/html/ergatis
            </p>
            <p>
                This takes the htdocs directories within the package and moves them into place, renaming both
                'ergatis' at the same time.  You can name this directory anything or, optionally, place the files directory
                under your server root.  Because the CGI scripts are also stored under the htdocs, you'll need to 
                modify your apache configuration to allow execution of these scripts and to prevent some files within
                the system from being displayed.
            </p>
            <p class='code'>
    &lt;Directory "/var/www/html/ergatis"&gt;
	    Options +ExecCGI
	    AllowOverride Limit 
	    DirectoryIndex index.html index.cgi
	    AddHandler cgi-script .cgi

	    &lt;FilesMatch "\.ini"&gt;
		    Deny from all
	    &lt;/FilesMatch&gt;
    &lt;/Directory&gt;
            </p>
            
            <a name='interface_configuration'></a>
            <h3>interface configuration</h3>
            <p>
                With the interface code now in place you'll want to edit the ergatis.ini file located at:
            </p>
            <p class='code'>
    /var/www/html/ergatis/cgi/ergatis.ini
            </p>
            <p>
                It is pretty heavily documented so you'll have information about every variable you need to set.  Once
                finished you can point your browser to
            </p>
            <p class='code'>
    http://yourserver/ergatis
            </p>
            
            <a name='software_path'></a>
            <h3>software path configuration</h3>
            <p>
                Many components in Ergatis execute external binaries such as blastall, glimmer3, etc. that can be 
                installed anywhere on your filesystem.  You'll need to tell Ergatis where each of these are by editing
                the software.config file under your ergatis directory:
            </p>

            <p class='code'>
    /opt/ergatis/software.config
            </p>
            <p>
                If you don't have access to some of these binaries or don't want them available you can edit the disabled
                component list in your ergatis.ini file.  This will prevent that component from being available when users
                build a pipeline.
            </p>
            
            <h3>check_installation.pl</h3>
            <p>
                Before we proceed you should run the installation verification script, passing the ergatis.ini file you
                just configured.  It performs a host of checks to ensure that the software is set up and configured
                correctly.
            </p>
            <p class='code'>
    ./check_installation.pl --ergatis_ini=/var/www/html/ergatis/cgi/ergatis.ini
            </p>
            
            <a name='project_area'></a>
            <h3>setting up a project area</h3>
            <p>
                Now that you have the software and interface set up you're ready to create a project area.  This will be
                where your pipelines and data are stored for any particular project.  In our example we decided to
                creating a project area for the annotation of the <span class='organism'>E. coli</span>, so we start by
                creating that directory:
            </p>
            <p class='code'>
    mkdir /usr/local/projects/e_coli
            </p>
            <p>
                You can then use the interface to create all the subdirectories and files necessary for a project area.
                Start by clicking the 'admin' tab followed by the 'create project' link.  Next enter the project directory
                path in the text box.  If there are any problems populating the area with the necessary files the interface
                will give a warning and allow you to try again until it's successful.  Once the area is made you'll be
                prompted to edit the project's config file.  Here you'll be able to specify which temp area and
                which ergatis directory you want to use (some sites have several.)  Most of the options on this form should
                be filled out automatically for you based on the values in the ergatis.ini file.  The only one you'll need 
                to be sure to change is the first - the project abbreviation.
            </p>
            <p>
                Once finished this will create the project are and all needed files and subdirectories.  Currently, it will
                not add your new project to the global project list visible on the left side of the home page.  Those are
                controlled by the entries at the bottom of the ergatis.ini file.  You can add an entry for it there, else 
                to go to your new project, enter the path (like /usr/local/projects/ecoli) into the text box at the bottom 
                of the page labeled 'project area'.
            </p>
            
            <h3>getting help</h3>
            <p>
                The primary support mechanism is the mailing lists hosted by sourceforge.  The link is found below and this
                should be the first place you write if you have problems.   There are several developers watching that list 
                to assist when necessary.  If you find a bug or want to request a feature, please use the tracker link.
            </p>
            <ul>
                <li><a href='http://sourceforge.net/mail/?group_id=148765'>Ergatis mailing lists</a></li>
                <li><a href='http://sourceforge.net/tracker/?group_id=148765'>Ergatis bug/feature request trackter</a></li>
            </ul>
        </div>


    </div> <!-- end content_container -->

    <div id="footer">
        <div id='official_links'>
            <a href='http://www.sf.net/projects/ergatis'><img src="http://sourceforge.net/sflogo.php?group_id=59541&amp;type=1" alt='sourceforge'></a>
            <a href='http://www.opensource.org/'><img src='http://opensource.org/trademarks/open_source_button.png' alt='open source'></a>
            <a href='http://www.getfirefox.com'><img src='../images/official_getfirefox.png' alt='get firefox'></a>
            <a href='http://www.perl.com'><img src='../images/official_perl.png' alt='perl'></a>
            <img src='../images/official_css2.png' alt='css2'>
        </div>
        <div id='license'>
            this project is licensed under the <a href='http://www.opensource.org/licenses/artistic-license.php'>Artistic License</a>.<br>
            questions should be directed to jorvis AT users.sf.net
        </div>

        <div style='clear: both;'>&nbsp;</div>
    </div>


</div> <!-- end page_container -->

</body>

</html>
